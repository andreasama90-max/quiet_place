<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Str√°≈æca ‚Äì Spr√°va Tich√©ho Miesta</title>
  <style>
    body {
      font-family: "Nunito Sans", sans-serif;
      background: linear-gradient(180deg, #f1f8f5, #eaf3f8);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    header {
      background-color: #8bc8ae;
      color: white;
      width: 100%;
      padding: 15px;
      text-align: center;
      font-size: 1.3rem;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }

    h2 {
      margin-top: 25px;
      color: #4b8370;
    }

    .section {
      width: 90%;
      max-width: 700px;
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .report {
      border-bottom: 1px solid #eee;
      padding: 15px 0;
    }

    .report:last-child {
      border-bottom: none;
    }

    .report p {
      margin: 5px 0;
    }

    .buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    button {
      border: none;
      border-radius: 8px;
      padding: 7px 15px;
      cursor: pointer;
      font-size: 0.95rem;
      transition: background 0.2s ease;
    }

    .approve {
      background: #a4d8ba;
      color: #1b4436;
    }
    .approve:hover { background: #8bc8ae; }

    .delete {
      background: #f5b4b4;
      color: #662626;
    }
    .delete:hover { background: #f09292; }

    #logout {
      background: #eee;
      color: #555;
      position: fixed;
      top: 10px;
      right: 10px;
      border-radius: 8px;
      padding: 6px 14px;
    }

    .empty {
      text-align: center;
      color: #777;
      font-style: italic;
      margin-top: 15px;
    }

    footer {
      margin: 30px 0;
      color: #888;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <header>üõ°Ô∏è Str√°≈æca ‚Äì Spr√°va Tich√©ho Miesta</header>
  <button id="logout">Odhl√°si≈• sa</button>

  <h2>Nahl√°sen√© pr√≠spevky</h2>
  <div class="section" id="postReports"></div>

  <h2>Nahl√°sen√© koment√°re</h2>
  <div class="section" id="commentReports"></div>

  <footer>üíö Str√°≈æcovia a Pomocn√≠ci chr√°nia Tich√© Miesto üíö</footer>

  <script>
    const ALLOWED = ["Str√°≈æca", "Pomocn√≠k", "Pomocn√≠k 2", "Pomocn√≠k 3"];
    const currentUser = localStorage.getItem("currentUser");

    // Ak nie je Str√°≈æca alebo Pomocn√≠k -> sp√§≈• na hlavn√∫ str√°nku
    if (!ALLOWED.includes(currentUser)) {
      alert("Nem√°≈° opr√°vnenie na pr√≠stup do tejto sekcie.");
      window.location.href = "index.html";
    }

    const postContainer = document.getElementById("postReports");
    const commentContainer = document.getElementById("commentReports");

    // Testovacie d√°ta (iba ak e≈°te niƒç neexistuje)
    if (!localStorage.getItem("postReports")) {
      const samplePosts = [
        { id: 1, author: "Luna", content: "C√≠tim sa na dne, neviem ƒço robi≈•...", reason: "nahl√°sen√© omylom" },
        { id: 2, author: "Alex", content: "V≈°etci s√∫ proti mne!", reason: "negat√≠vny t√≥n" }
      ];
      localStorage.setItem("postReports", JSON.stringify(samplePosts));
    }

    if (!localStorage.getItem("commentReports")) {
      const sampleComments = [
        { id: 1, author: "Marek", content: "Toto je hl√∫pos≈•!", reason: "vulgarizmus" },
        { id: 2, author: "Zoe", content: "√öplne s tebou s√∫hlas√≠m üíó", reason: "bez probl√©mu" }
      ];
      localStorage.setItem("commentReports", JSON.stringify(sampleComments));
    }

    function loadReports(key) {
      return JSON.parse(localStorage.getItem(key) || "[]");
    }

    function saveReports(key, data) {
      localStorage.setItem(key, JSON.stringify(data));
    }

    function renderSection(container, key) {
      const reports = loadReports(key);
      container.innerHTML = "";

      if (reports.length === 0) {
        container.innerHTML = `<div class="empty">≈Ωiadne nahl√°senia üå∏</div>`;
        return;
      }

      reports.forEach((rep, index) => {
        const div = document.createElement("div");
        div.className = "report";
        div.innerHTML = `
          <p><b>Autor:</b> ${rep.author}</p>
          <p><b>Obsah:</b> ${rep.content}</p>
          <p><b>D√¥vod nahl√°senia:</b> ${rep.reason}</p>
          <div class="buttons">
            <button class="approve">‚úÖ Schv√°li≈•</button>
            <button class="delete">üóëÔ∏è Zmaza≈•</button>
          </div>
        `;

        const approveBtn = div.querySelector(".approve");
        const deleteBtn = div.querySelector(".delete");

        approveBtn.onclick = () => {
          reports.splice(index, 1);
          saveReports(key, reports);
          renderSection(container, key);
          alert("Obsah bol schv√°len√Ω a odstr√°nen√Ω zo zoznamu üåø");
        };

        deleteBtn.onclick = () => {
          reports.splice(index, 1);
          saveReports(key, reports);
          renderSection(container, key);
          alert("Obsah bol odstr√°nen√Ω zo syst√©mu üóëÔ∏è");
        };

        container.appendChild(div);
      });
    }

    // üîß Opraven√© odhl√°senie ‚Äì funguje spoƒæahlivo
    document.getElementById("logout").onclick = () => {
      alert("Bolo ti prian√© veƒæa pokoja üåø ‚Äî √∫spe≈°ne si sa odhl√°sil.");
      localStorage.removeItem("currentUser");
      setTimeout(() => window.location.href = "index.html", 250);
    };

    renderSection(postContainer, "postReports");
    renderSection(commentContainer, "commentReports");
  </script>
</body>
</html>
