<!DOCTYPE html> 
<html lang="sk"> 
  <head> 
    <meta charset="UTF-8" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
    <title>Tich√© Miesto ‚Äì Prihl√°senie</title> 
    <style> body { font-family: "Nunito Sans", sans-serif; 
                  background: linear-gradient(180deg, #E8F4FB, #FDFDFD); 
                  color: #333; 
                  display: flex; 
                  flex-direction: column; 
                  align-items: center; 
                  justify-content: center; 
                  height: 100vh; margin: 0; 
                  transition: background 0.5s ease; } 
      h1 { color: #4b8370; 
          font-size: 2rem; 
          margin-bottom: 10px; } 
      p { color: #666; 
         font-size: 1rem; 
         margin-bottom: 20px; } 
      .login-box { background: #ffffff; 
                  border-radius: 15px; 
                  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); 
                  padding: 30px; width: 90%; 
                  max-width: 400px; 
                  text-align: center; } 
      input { width: 90%; 
             padding: 10px; 
             margin: 10px 0; 
             border-radius: 10px; 
             border: 1px solid #bcd5ca; 
             font-size: 1rem; 
             font-family: "Nunito Sans", sans-serif; 
             color: #333; } 
      button { background: #8bc8ae; 
              color: white; 
              border: none; 
              border-radius: 10px; 
              padding: 10px 25px; 
              cursor: pointer; 
              font-size: 1rem; 
              transition: background 0.3s ease; 
             } 
      button:hover { background: #77b69c; } 
      .secondary-btn 
      { background: #f7fff9; 
       color: #3e6e5d; 
       border: 1px solid #b9e0ca; 
       border-radius: 20px; 
       padding: 8px 16px; 
       cursor: pointer; 
       transition: all 0.25s ease; 
      } 
      .secondary-btn:hover { 
        background: #e1f4ea; 
      } 
      .message { 
        margin-top: 15px; 
        font-weight: 600; 
      } 
      
      /* jazykov√Ω prep√≠naƒç */ 
      .language-switch { 
        position: fixed; 
        top: 10px; 
        right: 10px; 
        display: flex; 
        gap: 8px; } 
      .language-switch button { 
        background: #f1f9f6; 
        color: #4b8370; 
        border: 1px solid #bcd5ca; 
        padding: 4px 8px; 
        border-radius: 6px; 
        font-size: 0.8rem; 
        cursor: pointer; } 
      .language-switch button.active 
      { background: #8bc8ae; 
       color: white; font-weight: bold; 
      } 
      
      /* Modal */ .modal { display: none; position: fixed; z-index: 20; 
                          left: 0; top: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); } 
      .modal-content { background: white; margin: 10% auto; padding: 20px 30px; 
                      border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); max-width: 400px;
                      text-align: left; } 
      .modal-content h3 { text-align: center; color: #3e6e5d; margin-bottom: 15px; } 
      .modal-content input { width: 100%; padding: 8px 10px; margin-bottom: 12px; 
                            border: 1px solid #ccc; border-radius: 8px; font-family: inherit; } 
      .close { float: right; font-size: 1.5rem; cursor: pointer; color: #888; } 
      .close:hover { color: #000; } 
    </style> 
  </head> 
  <body> 
    
    <!-- prep√≠naƒç jazykov --> 
    <div class="language-switch"> 
      <button data-lang="sk" class="active">üá∏üá∞ SK</button> 
      <button data-lang="en">üá¨üáß EN</button> 
      <button data-lang="cz">üá®üáø CZ</button> 
    </div> 
    <h1 id="title">üå∏ Tich√© Miesto</h1> 
    <p id="subtitle">Priestor, kde m√¥≈æe≈° by≈• s√°m sebou ‚Äì bezpeƒçne a v pokoji üåø</p> 
    <p id="subtitle">(Just write any nickname and password, it will registred you)</p>
    <div class="login-box"> 
      <input type="text" id="nickname" placeholder="Prez√Ωvka" maxlength="16" /> 
      <input type="password" id="password" placeholder="Heslo (4‚Äì16 symbolov)" maxlength="16" /> 
      <button id="loginBtn">Prihl√°si≈• sa</button> <div class="message" id="message">
        
      </div> 
    </div> 
    <div style="text-align:center; margin-top:10px;"> 
      <button class="secondary-btn" id="changePasswordBtn">üîë Zmeni≈• heslo</button> </div> <div id="passwordModal" class="modal"> <div class="modal-content"> <span class="close" id="closeModal">&times;</span> <h3 id="modalTitle">Zmeni≈• heslo</h3> <label id="oldPassLabel">Star√© heslo:</label> <input type="password" id="oldPassword" placeholder="Zadaj star√© heslo"> <label id="newPassLabel">Nov√© heslo:</label> <input type="password" id="newPassword" placeholder="Zadaj nov√© heslo"> <label id="confirmPassLabel">Potvrƒè nov√© heslo:</label> <input type="password" id="confirmPassword" placeholder="Zopakuj nov√© heslo"> 
  <button class="post-btn" id="savePassword">Ulo≈æi≈• nov√© heslo</button> 
</div> 
</div>

<script>
/* ========= TRANSLATIONS & UI TEXTS ========= */
const translations = {
  sk: {
    title: "üå∏ Tich√© Miesto",
    subtitle: "Priestor, kde m√¥≈æe≈° by≈• s√°m sebou ‚Äì bezpeƒçne a v pokoji üåø",
    nickname: "Prez√Ωvka",
    password: "Heslo (4‚Äì16 symbolov)",
    loginBtn: "Prihl√°si≈• sa",
    changePass: "üîë Zmeni≈• heslo",
    modalTitle: "Zmeni≈• heslo",
    oldPass: "Star√© heslo:",
    newPass: "Nov√© heslo:",
    confirmPass: "Potvrƒè nov√© heslo:",
    save: "Ulo≈æi≈• nov√© heslo",
    fillFields: "Pros√≠m, vypl≈à v≈°etky polia üå∏",
    passLength: "Heslo mus√≠ ma≈• 4 a≈æ 16 znakov üîí",
    wrongPass: "Nespr√°vne heslo ‚Äî sk√∫s to znova üíó",
    welcomeNew: "Vitaj, {name} ‚Äî √∫ƒçet vytvoren√Ω. Presmerov√°vam ≈•a do komunity üå∏",
    welcomeBack: "Vitaj sp√§≈•, {name} ‚Äî presmerov√°vam ≈•a... üåø",
    guardianWrong: "Nespr√°vne heslo pre Str√°≈æcu / Pomocn√≠ka üîí",
    guardianWelcome: "Vitaj, {name} ‚Äî presmerov√°vam ≈•a do spr√°vy... üå∏",
    changePassNoUser: "Najprv sa prihl√°s üåø",
    changePassWrongOld: "Star√© heslo nie je spr√°vne ‚ùå",
    changePassShort: "Nov√© heslo mus√≠ ma≈• aspo≈à 4 znaky üîí",
    changePassMismatch: "Hesl√° sa nezhoduj√∫ ‚ö†Ô∏è",
    changePassSuccess: "Heslo bolo √∫spe≈°ne zmenen√© üåø"
  },
  en: {
    title: "üå∏ Quiet Place",
    subtitle: "A space where you can be yourself ‚Äì safe and calm üåø",
    nickname: "Nickname",
    password: "Password (4‚Äì16 symbols)",
    loginBtn: "Log In",
    changePass: "üîë Change Password",
    modalTitle: "Change Password",
    oldPass: "Old Password:",
    newPass: "New Password:",
    confirmPass: "Confirm Password:",
    save: "Save New Password",
    fillFields: "Please, fill all fields üå∏",
    passLength: "Password must be 4 to 16 characters üîí",
    wrongPass: "Wrong password ‚Äî try again üíó",
    welcomeNew: "Welcome, {name} ‚Äî account created. Redirecting to community üå∏",
    welcomeBack: "Welcome back, {name} ‚Äî redirecting... üåø",
    guardianWrong: "Wrong guardian/helper password üîí",
    guardianWelcome: "Welcome, {name} ‚Äî redirecting to dashboard... üå∏",
    changePassNoUser: "Please log in first üåø",
    changePassWrongOld: "Old password is incorrect ‚ùå",
    changePassShort: "New password must be at least 4 characters üîí",
    changePassMismatch: "Passwords do not match ‚ö†Ô∏è",
    changePassSuccess: "Password changed successfully üåø"
  },
  cz: {
    title: "üå∏ Tich√© M√≠sto",
    subtitle: "Prostor, kde m≈Ø≈æe≈° b√Ωt s√°m sebou ‚Äì v bezpeƒç√≠ a klidu üåø",
    nickname: "P≈ôezd√≠vka",
    password: "Heslo (4‚Äì16 symbol≈Ø)",
    loginBtn: "P≈ôihl√°sit se",
    changePass: "üîë Zmƒõnit heslo",
    modalTitle: "Zmƒõnit heslo",
    oldPass: "Star√© heslo:",
    newPass: "Nov√© heslo:",
    confirmPass: "Potvrƒè nov√© heslo:",
    save: "Ulo≈æit nov√© heslo",
    fillFields: "Pros√≠m, vypl≈à v≈°echny pole üå∏",
    passLength: "Heslo mus√≠ m√≠t 4 a≈æ 16 znak≈Ø üîí",
    wrongPass: "Nespr√°vn√© heslo ‚Äî zkus to znovu üíó",
    welcomeNew: "V√≠tej, {name} ‚Äî √∫ƒçet vytvo≈ôen. P≈ôesmƒõrov√°v√°m do komunity üå∏",
    welcomeBack: "V√≠tej zpƒõt, {name} ‚Äî p≈ôesmƒõrov√°v√°m... üåø",
    guardianWrong: "Nespr√°vn√© heslo pro Str√°≈æce / Pomocn√≠ka üîí",
    guardianWelcome: "V√≠tej, {name} ‚Äî p≈ôesmƒõrov√°v√°m do spr√°vy... üå∏",
    changePassNoUser: "Nejprve se pros√≠m p≈ôihlas üåø",
    changePassWrongOld: "Star√© heslo nen√≠ spr√°vn√© ‚ùå",
    changePassShort: "Nov√© heslo mus√≠ m√≠t alespo≈à 4 znaky üîí",
    changePassMismatch: "Hesla se neshoduj√≠ ‚ö†Ô∏è",
    changePassSuccess: "Heslo bylo √∫spƒõ≈°nƒõ zmƒõnƒõno üåø"
  }
};

/* ========= UI ELEMENTS ========= */
const switchButtons = document.querySelectorAll(".language-switch button");
const titleEl = document.getElementById("title");
const subtitleEl = document.getElementById("subtitle");
const nicknameInput = document.getElementById("nickname");
const passwordInput = document.getElementById("password");
const loginBtn = document.getElementById("loginBtn");
const changePasswordBtn = document.getElementById("changePasswordBtn");
const messageEl = document.getElementById("message");

/* ========= GUARDIANS ========= */
const GUARDIANS = ["Str√°≈æca", "Pomocn√≠k", "Pomocn√≠k 2", "Pomocn√≠k 3"];
const GUARDIAN_PASSWORD = "spravedlnos≈•";

/* ========= Helpers for users storage ========= */
function loadUsers() {
  try { return JSON.parse(localStorage.getItem("users") || "{}"); }
  catch { return {}; }
}
function saveUsers(obj) { localStorage.setItem("users", JSON.stringify(obj)); }

/* ========= LANGUAGE ========== */
function applyTranslations(lang) {
  const t = translations[lang];
  titleEl.textContent = t.title;
  subtitleEl.textContent = t.subtitle;
  nicknameInput.placeholder = t.nickname;
  passwordInput.placeholder = t.password;
  loginBtn.textContent = t.loginBtn;
  changePasswordBtn.textContent = t.changePass;
  document.getElementById("modalTitle").textContent = t.modalTitle;
  document.getElementById("oldPassLabel").textContent = t.oldPass;
  document.getElementById("newPassLabel").textContent = t.newPass;
  document.getElementById("confirmPassLabel").textContent = t.confirmPass;
  document.getElementById("savePassword").textContent = t.save;

  // active class on buttons
  switchButtons.forEach(b => b.classList.remove("active"));
  const btn = document.querySelector(`[data-lang="${lang}"]`);
  if (btn) btn.classList.add("active");
  localStorage.setItem("lang", lang);
}
switchButtons.forEach(btn => btn.addEventListener("click", () => applyTranslations(btn.dataset.lang)));
const savedLang = localStorage.getItem("lang") || "sk";
applyTranslations(savedLang);

/* ========= LOGIN / REGISTER LOGIC ========= */
loginBtn.addEventListener("click", () => {
  const name = nicknameInput.value.trim();
  const pass = passwordInput.value;

  const t = translations[localStorage.getItem("lang") || savedLang];

  if (!name || !pass) {
    messageEl.style.color = "#cf6b85";
    messageEl.textContent = t.fillFields;
    return;
  }
  if (pass.length < 4 || pass.length > 16) {
    messageEl.style.color = "#cf6b85";
    messageEl.textContent = t.passLength;
    return;
  }

  // guardians
  if (GUARDIANS.includes(name)) {
    if (pass !== GUARDIAN_PASSWORD) {
      messageEl.style.color = "#cf6b85";
      messageEl.textContent = t.guardianWrong;
      return;
    }
    localStorage.setItem("currentUser", name);
    localStorage.setItem("nickname", name);
    messageEl.style.color = "#4b8370";
    messageEl.textContent = t.guardianWelcome.replace("{name}", name);
    setTimeout(() => window.location.href = "guardian_dashboard.html", 900);
    return;
  }

  // normal users
  const users = loadUsers();
  if (users.hasOwnProperty(name)) {
    if (users[name] !== pass) {
      messageEl.style.color = "#cf6b85";
      messageEl.textContent = t.wrongPass;
      return;
    }
    localStorage.setItem("currentUser", name);
    localStorage.setItem("nickname", name);
    messageEl.style.color = "#4b8370";
    messageEl.textContent = t.welcomeBack.replace("{name}", name);
    setTimeout(() => window.location.href = "community.html", 700);
    return;
  }

  // register new
  users[name] = pass;
  saveUsers(users);
  localStorage.setItem("currentUser", name);
  localStorage.setItem("nickname", name);
  messageEl.style.color = "#4b8370";
  messageEl.textContent = t.welcomeNew.replace("{name}", name);
  setTimeout(() => window.location.href = "community.html", 900);
});

/* ========= AUTO-REDIRECT IF ALREADY LOGGED ========= */
(function autoRedirectIfLogged(){
  const cur = localStorage.getItem("currentUser");
  if (!cur) return;
  if (GUARDIANS.includes(cur)) setTimeout(()=>window.location.href="guardian_dashboard.html", 300);
  else setTimeout(()=>window.location.href="community.html", 300);
})();

/* ========= PASSWORD MODAL (open/close/save) ========= */
const modal = document.getElementById("passwordModal");
const closeModal = document.getElementById("closeModal");
const savePasswordBtn = document.getElementById("savePassword");

changePasswordBtn.addEventListener("click", () => {
  modal.style.display = "block";
});
closeModal.addEventListener("click", () => modal.style.display = "none");
window.addEventListener("click", (e) => { if (e.target === modal) modal.style.display = "none"; });

savePasswordBtn.addEventListener("click", () => {
  const oldPass = document.getElementById("oldPassword").value.trim();
  const newPass = document.getElementById("newPassword").value.trim();
  const confirmPass = document.getElementById("confirmPassword").value.trim();
  const cur = localStorage.getItem("currentUser");
  const t = translations[localStorage.getItem("lang") || savedLang];

  if (!cur) { alert(t.changePassNoUser); return; }

  const users = loadUsers();
  if (!users[cur] || users[cur] !== oldPass) { alert(t.changePassWrongOld); return; }
  if (newPass.length < 4) { alert(t.changePassShort); return; }
  if (newPass !== confirmPass) { alert(t.changePassMismatch); return; }

  users[cur] = newPass;
  saveUsers(users);
  alert(t.changePassSuccess);
  modal.style.display = "none";
  document.getElementById("oldPassword").value = "";
  document.getElementById("newPassword").value = "";
  document.getElementById("confirmPassword").value = "";
});

/* ========= Optional: press Enter to login ========= */
[nicknameInput, passwordInput].forEach(el => {
  el.addEventListener("keydown", (e) => {
    if (e.key === "Enter") loginBtn.click();
  });
});
</script>

  </body> 
</html>






